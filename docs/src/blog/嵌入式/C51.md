# C51

::: details 其中涉及到的一些知识点

-   delay

    延时函数：51 单片机的时钟频率为 12 MHz,转换成 Hz 就是 $12×10^9$ Hz，也就是一个时钟周期可以执行 $12×10^9$ 次指令，那么一次指令的耗时就是
    $$ {1 \over 12×10^9} (s) $$
    而我们使用 `delay(50000)` ，花费的时间就是
    $$ {50000 \over 12×10^9} (s) $$
    大概就是 4.17 毫秒（ms）

:::

## 点灯

### 闪烁

```c
#include <reg52.h>

// 用sbit来定义一个I/O口
// 至于为什么是P0^0，因为这个是固定的，不同的单片机是不同的，要看单片机文档
sbit LED = P0 ^ 0;

void delay(unsigned int t)
{
    while (t--);
}

void main(void)
{

    while (1) {
        // 将P0.0口赋值 0，该口电平为低，使LED亮
        // 如果想赋值 1为亮，则根据半导体性质，将LED灯反过来接即可
        // 下面代码每隔一段时间调整LED口的电压，实现闪烁功能
        LED = 0;
        delay(50000);
        LED = 1;
        delay(50000);
    }
}
```

<image src="https://raw.githubusercontent.com/Lazydd/images/main/202411281605109.webp" />

### 流水灯

```c
#include <reg52.h>

void delay(unsigned int t)
{
    while (t--);
}

void main(void)
{
    int i;
    while (1)
    {
        for (i = 0; i < 8; i++) {
            /**
            * 我们有8个LED灯，每次让一个LED灯亮,就是让改口的电压为0
            * 数字 1 的二进制为 00000001，对他取反就是 11111110,很轻松
            * 实现了一个灯的亮，1 左移1位的二进制是 00000010，取反就是
            * 11111101 实现了第二个的灯亮，以此类推实现流水灯
            */
            P0 = ~(1 << i);
            delay(5000);
        }
    }
}
```

<image src="https://raw.githubusercontent.com/Lazydd/images/main/202411281610000.webp" />

## 数码管

### 展示数字

我们选择的是共阳极数码管

```c
#include <reg52.h>

void main(void)
{
    while (1) {
        P0 = 0xC0;
    }
}
```

<image src="https://raw.githubusercontent.com/Lazydd/images/main/202411281641176.webp" />

更具需要选择对应的值来展示不同的数字

<image src="https://raw.githubusercontent.com/Lazydd/images/main/202411281637979.webp" />

### 数字滚动

```c
#include <reg52.h>

void delay(unsigned int t)
{
    while (t--);
}

int seg[10] = {0xC0, 0xF9, 0xA4, 0xB0, 0x99, 0x92, 0x82, 0xF8, 0x80, 0x90};
void main(void)
{
    int i;
    while (1) {
        for (i = 0; i < 10; i++) {
            P0 = seg[i];
            delay(50000);
        }
    }
}

```

<image src="https://raw.githubusercontent.com/Lazydd/images/main/202411281652175.webp" />

### 动态扫描

```c
#include <reg52.h>

void delay(unsigned int t)
{
    while (t--);
}

int seg[10] = {0xC0, 0xF9, 0xA4, 0xB0, 0x99, 0x92, 0x82, 0xF8, 0x80, 0x90};
void main(void)
{
    int i;
    int num;
    while (1) {
        num++;
        for (i = 0; i < 4; i++) {
            P2 = 1 << i;
            if (i == 0) {
                P0 = seg[num / 1000];
            } else if (i == 1) {
                P0 = seg[num % 1000 / 100];
            } else if (i == 2) {
                P0 = seg[num % 100 / 10];
            } else if (i == 3) {
                P0 = seg[num % 10];
            }
            /**
            * 刷新率在50Hz以上，人眼差不多就无法分辨出来了，所以延迟要
            * 少于某个阈值即可实现，500并非固定
            */
            delay(500);
            P0 = 0xff; // 消除拖影
        }
        if (num >= 9999) {
            num = 0;
        }
    }
}

```

<image src="https://raw.githubusercontent.com/Lazydd/images/main/202411281955072.webp" />

## 点阵

### 跳动的心
